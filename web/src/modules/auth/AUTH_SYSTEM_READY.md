# ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤–∞!

## üéâ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –±–µ–∫–µ–Ω–¥ API.

---

## üì¶ –®–ê–ì 1: –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–í—ã–ø–æ–ª–Ω–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–≤ –ø–∞–ø–∫–µ `web/`):

```bash
npm install @radix-ui/react-toast lucide-react class-variance-authority
```

---

## üî• –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `apiClient` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç Bearer —Ç–æ–∫–µ–Ω:

```tsx
import { apiClient } from "@/lib/apiClient";

// –¢–æ–∫–µ–Ω –¥–æ–±–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
const users = await apiClient.get("/auth/users");
```

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **401** - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/unauthorized` + –æ—á–∏—Å—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞
- **403** - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/forbidden` + toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- **–ò—Å—Ç—ë–∫—à–∏–π —Ç–æ–∫–µ–Ω** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤

```tsx
import { ProtectedRoute } from "@/modules/auth/components";
import { RoleType } from "@/constants/roles";

// –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ –≤—ã—à–µ
<ProtectedRoute allowedRoles={[RoleType.ADMIN]}>
  <AdminPanel />
</ProtectedRoute>;
```

### ‚úÖ –£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥

```tsx
import { RoleGuard, PermissionGuard } from "@/modules/auth/components";

// –ü–æ —Ä–æ–ª—è–º
<RoleGuard allowedRoles={[RoleType.ADMIN]}>
  <button>–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å–µ</button>
</RoleGuard>

// –ü–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º
<PermissionGuard permission="edit:arts">
  <button>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞—Ä—Ç–∏–∫—É–ª–∏</button>
</PermissionGuard>
```

### ‚úÖ –•—É–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤

```tsx
import { useRole, usePermission } from "@/modules/auth/hooks";

function MyComponent() {
  const { isAdmin, isPrime, hasRole } = useRole();
  const { can, canEditResource } = usePermission();

  return (
    <>
      {isAdmin && <AdminButton />}
      {can("edit:arts") && <EditButton />}
      {canEditResource(ownerId) && <EditMyStuff />}
    </>
  );
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### –°–æ–∑–¥–∞–Ω–æ:

```
web/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ constants/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ roles.ts                    # ‚≠ê –†–æ–ª–∏ –∏ –∏–µ—Ä–∞—Ä—Ö–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ components/ui/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ toast.tsx                   # Toast –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ toaster.tsx                 # Toast –ø—Ä–æ–≤–∞–π–¥–µ—Ä
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-toast.ts                # Toast —Ö—É–∫
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apiClient.tsx               # ‚≠ê –û–±–Ω–æ–≤–ª—ë–Ω —Å interceptors
‚îÇ   ‚îî‚îÄ‚îÄ modules/auth/
‚îÇ       ‚îú‚îÄ‚îÄ api/types/index.ts          # ‚≠ê –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã (RoleType)
‚îÇ       ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ProtectedRoute.tsx      # ‚≠ê –û–±–Ω–æ–≤–ª—ë–Ω —Å allowedRoles
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ RoleGuard.tsx           # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ PermissionGuard.tsx     # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ResourceOwnerGuard.tsx  # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useRole.ts              # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ usePermission.ts        # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îú‚îÄ‚îÄ pages/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ forbidden.tsx           # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îú‚îÄ‚îÄ providers/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ auth-provider.tsx       # ‚≠ê –û–±–Ω–æ–≤–ª—ë–Ω (hasRole, hasAnyRole)
‚îÇ       ‚îú‚îÄ‚îÄ types/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ errors.ts               # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îú‚îÄ‚îÄ utils/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ token.ts                # ‚≠ê –ù–æ–≤—ã–π
‚îÇ       ‚îú‚îÄ‚îÄ USAGE_EXAMPLES.md           # üìñ –ü—Ä–∏–º–µ—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ INSTALLATION.md             # üìñ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ FRONTEND_IMPLEMENTATION_SUMMARY.md  # üìñ –†–µ–∑—é–º–µ
```

---

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤—Å—ë –Ω–∞ –º–µ—Å—Ç–µ

–§–∞–π–ª `web/src/App.tsx` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

```tsx
import { Toaster } from "@/components/ui/toaster";

function App() {
  return (
    <div>
      {/* —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */}
      <Toaster /> {/* ‚Üê –î–æ–ª–∂–µ–Ω –±—ã—Ç—å! */}
    </div>
  );
}
```

‚úÖ –£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ!

### 2. –ü—Ä–æ–≤–µ—Ä—å AuthProvider

–§–∞–π–ª `web/src/providers/providers.tsx`:

```tsx
<AuthProvider>
  <QueryProvider>...</QueryProvider>
</AuthProvider>
```

‚úÖ –£–∂–µ –µ—Å—Ç—å!

### 3. –ù–∞—á–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!

–°–º. –ø—Ä–∏–º–µ—Ä—ã –≤ `web/src/modules/auth/USAGE_EXAMPLES.md`

---

## üõ°Ô∏è –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤

| –î–µ–π—Å—Ç–≤–∏–µ                  | USER | ADMIN | PRIME |
| ------------------------- | ---- | ----- | ----- |
| –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö             | ‚úÖ   | ‚úÖ    | ‚úÖ    |
| –°–æ–∑–¥–∞–Ω–∏–µ asks             | ‚úÖ   | ‚úÖ    | ‚úÖ    |
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–∏—Ö asks | ‚úÖ   | ‚úÖ    | ‚úÖ    |
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–∂–∏—Ö asks | ‚ùå   | ‚úÖ    | ‚úÖ    |
| –°–æ–∑–¥–∞–Ω–∏–µ arts/pallets     | ‚ùå   | ‚úÖ    | ‚úÖ    |
| –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π        | ‚ùå   | ‚úÖ    | ‚úÖ    |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ | ‚ùå   | ‚úÖ    | ‚úÖ    |

---

## üîß –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:

1. **–î–æ–±–∞–≤—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

   ```tsx
   // –°–∫—Ä–æ–π –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   <PermissionGuard permission="delete:pallets">
     <DeleteButton />
   </PermissionGuard>
   ```

2. **–ó–∞—â–∏—Ç–∏ –∞–¥–º–∏–Ω—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**

   ```tsx
   // –í router.tsx
   <ProtectedRoute allowedRoles={[RoleType.ADMIN]}>
     <AdminDashboard />
   </ProtectedRoute>
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π ResourceOwnerGuard –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

   ```tsx
   <ResourceOwnerGuard ownerId={ask.asker} action="edit">
     <EditButton />
   </ResourceOwnerGuard>
   ```

4. **–î–æ–±–∞–≤—å —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ –º–µ–Ω—é:**
   ```tsx
   const { isAdmin } = useRole();
   {
     isAdmin && <MenuItem to="/admin">–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</MenuItem>;
   }
   ```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **USAGE_EXAMPLES.md** - –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
2. **FRONTEND_IMPLEMENTATION_SUMMARY.md** - —á—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
3. **INSTALLATION.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
4. **FRONTEND_AUTH_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ç –±–µ–∫–µ–Ω–¥–∞

---

## üéä –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!

**–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–ª–µ–¥—É—é—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º.**

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã?

–°–º–æ—Ç—Ä–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ –ø–∞–ø–∫–µ `web/src/modules/auth/`

**–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üöÄ**
